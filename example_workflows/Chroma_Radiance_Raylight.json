{
  "id": "b2d37916-fab5-425f-850d-7a64886e4d54",
  "revision": 0,
  "last_node_id": 773,
  "last_link_id": 1395,
  "nodes": [
    {
      "id": 298,
      "type": "VAEDecode",
      "pos": [
        -840,
        1090
      ],
      "size": [
        140,
        46
      ],
      "flags": {
        "collapsed": false
      },
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 1389
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 1252
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            1341
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode",
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": []
    },
    {
      "id": 710,
      "type": "VAELoader",
      "pos": [
        -840,
        1180
      ],
      "size": [
        210,
        58
      ],
      "flags": {
        "collapsed": false
      },
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "links": [
            1252
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAELoader",
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "pixel_space"
      ]
    },
    {
      "id": 740,
      "type": "SaveImage",
      "pos": [
        -610,
        540
      ],
      "size": [
        1130,
        1150
      ],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 1341
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "SaveImage",
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "Chroma-Radiance"
      ]
    },
    {
      "id": 759,
      "type": "Note",
      "pos": [
        -840,
        1280
      ],
      "size": [
        220,
        100
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "This Chroma1 Radiance image generation is in pixel space. No additional VAE is needed."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 760,
      "type": "EmptyChromaRadianceLatentImage",
      "pos": [
        -1940.6736012217784,
        1418.6035585646857
      ],
      "size": [
        354.75334414827535,
        173.31673763387516
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            1393
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "EmptyChromaRadianceLatentImage",
        "cnr_id": "comfy-core",
        "ver": "0.3.60",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        1024,
        1024,
        1
      ],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 761,
      "type": "RayUNETLoader",
      "pos": [
        -1926.4103173350884,
        1085.9819322921935
      ],
      "size": [
        270,
        102
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors_init",
          "type": "RAY_ACTORS_INIT",
          "link": 1395
        },
        {
          "name": "lora",
          "shape": 7,
          "type": "RAY_LORA",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "links": [
            1383,
            1384
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayUNETLoader"
      },
      "widgets_values": [
        "windows/Chroma1-Radiance-v0.4.safetensors",
        "default"
      ]
    },
    {
      "id": 733,
      "type": "CLIPLoader",
      "pos": [
        -1933.913167856438,
        617.7381895615009
      ],
      "size": [
        260,
        110
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            1342
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "CLIPLoader",
        "cnr_id": "comfy-core",
        "ver": "0.3.57",
        "models": [
          {
            "name": "t5xxl_fp8_e4m3fn_scaled.safetensors",
            "url": "https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/t5xxl_fp8_e4m3fn_scaled.safetensors",
            "directory": "text_encoders"
          }
        ],
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "windows/t5xxl_fp8_e4m3fn.safetensors",
        "chroma",
        "default"
      ]
    },
    {
      "id": 766,
      "type": "RayBetaSamplingScheduler",
      "pos": [
        -1531.775627157974,
        1149.8524052451887
      ],
      "size": [
        357.14999545633816,
        181.20541782534497
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "link": 1394
        }
      ],
      "outputs": [
        {
          "name": "SIGMAS",
          "type": "SIGMAS",
          "links": [
            1391
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayBetaSamplingScheduler"
      },
      "widgets_values": [
        30,
        0.4,
        0.4
      ]
    },
    {
      "id": 700,
      "type": "KSamplerSelect",
      "pos": [
        -1524.7637845037948,
        1380.4169490519635
      ],
      "size": [
        341.8987328013741,
        136.6764371095917
      ],
      "flags": {
        "collapsed": false
      },
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "SAMPLER",
          "type": "SAMPLER",
          "links": [
            1387
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "KSamplerSelect",
        "cnr_id": "comfy-core",
        "ver": "0.3.49",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "euler"
      ]
    },
    {
      "id": 764,
      "type": "RayModelSamplingAuraFlow",
      "pos": [
        -1519.569982531152,
        771.6644981599792
      ],
      "size": [
        266.5393603630131,
        58
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "link": 1383
        }
      ],
      "outputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "links": [
            1394
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayModelSamplingAuraFlow"
      },
      "widgets_values": [
        1
      ]
    },
    {
      "id": 741,
      "type": "T5TokenizerOptions",
      "pos": [
        -1530.200450328263,
        595.738311735701
      ],
      "size": [
        260,
        82
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 1342
        }
      ],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            1343,
            1344
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "T5TokenizerOptions",
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        0,
        0
      ]
    },
    {
      "id": 728,
      "type": "CLIPTextEncode",
      "pos": [
        -1035.2591201276455,
        827.6173095928827
      ],
      "size": [
        350,
        210
      ],
      "flags": {
        "collapsed": false
      },
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 1344
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [
            1385
          ]
        }
      ],
      "title": "Negative",
      "properties": {
        "Node name for S&R": "CLIPTextEncode",
        "cnr_id": "comfy-core",
        "ver": "0.3.52",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "This low quality greyscale unfinished sketch is inaccurate and flawed. The image is very blurred and lacks detail with excessive chromatic aberrations and artifacts. The image is overly saturated with excessive bloom. It has a toony aesthetic with bold outlines and flat colors. "
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 693,
      "type": "CLIPTextEncode",
      "pos": [
        -1042.621888306352,
        568.9481759744707
      ],
      "size": [
        360,
        210
      ],
      "flags": {
        "collapsed": false
      },
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 1343
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [
            1386
          ]
        }
      ],
      "title": "Positive",
      "properties": {
        "Node name for S&R": "CLIPTextEncode",
        "cnr_id": "comfy-core",
        "ver": "0.3.52",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "Hyperrealistic macro photograph of two miniature robots—each precisely 2 inches tall—collaborating to repair a cybernetic black feather with intricate biomechanical details. The feather combines organic softness with sleek metallic components: fine, iridescent barbs made of carbon fiber shimmer subtly, while glowing microcircuits trace through its spine like veins of light. One robot, with delicate multi-jointed arms, uses a precision micro-soldering tool to reconnect a glowing filament along the feather’s shaft, tiny sparks reflecting in its glassy sensor eyes. The other kneels beside it, using a miniature nanospanner to adjust a cracked metallic vane, its chrome surface reflecting the warm, ambient glow.\n\nThe scene is bathed in soft, cinematic workshop lighting—gentle highlights glinting off brushed metal surfaces, with a shallow depth of field that keeps the focus razor-sharp on the robots and feather, while the background fades into a dreamy blur of blurred tools and ambient LEDs. Floating motes of dust drift through beams of light, enhancing the realism and sense of scale. Ultra-detailed, 8K photorealistic textures capture every nuance: faint scratches on the robots’ metallic casings, the soft fibers merging into alloy plates on the feather, subtle reflections in the workspace, and the faint whir of micro-servos implied through motion blur. The color palette balances cool silvers, deep blacks, and warm golden highlights, creating a cozy yet futuristic atmosphere that fuses precision engineering with delicate artistry."
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 765,
      "type": "XFuserSamplerCustom",
      "pos": [
        -1157.1436940218853,
        1142.4145221402975
      ],
      "size": [
        274.16522314109625,
        407.1376841393892
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "link": 1384
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 1386
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 1385
        },
        {
          "name": "sampler",
          "type": "SAMPLER",
          "link": 1387
        },
        {
          "name": "sigmas",
          "type": "SIGMAS",
          "link": 1391
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 1393
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "LATENT",
          "links": [
            1389
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "XFuserSamplerCustom"
      },
      "widgets_values": [
        true,
        796567098644297,
        "randomize",
        3.5
      ]
    },
    {
      "id": 768,
      "type": "MarkdownNote",
      "pos": [
        -2336.373911714702,
        297.2436039710754
      ],
      "size": [
        359.8093566894531,
        188.35037231445312
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "\nRaylight uses **FSDP2** to shard the model across GPUs.\n\nIn rare cases, a memory leak may occur when switching from one LoRA to another while using FSDP. However, in most tests this issue does not appear, even with the same Docker setup....\n\nIf memory leak cases continue to grow, I will force a reinitialization of the Ray worker.\n\nIn the meantime, if you encounter this issue, please restart Comfy.\nOpen Issue on [Raylight Issue](https://github.com/komikndr/raylight/issues)\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 771,
      "type": "Note",
      "pos": [
        -1721.4024232955921,
        369.8524694006425
      ],
      "size": [
        215.3394317626953,
        117.74829864501953
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Glosarry",
      "properties": {},
      "widgets_values": [
        "rank = id assigned to the GPU\nworld_size = number of GPUs\n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 773,
      "type": "RayInitializer",
      "pos": [
        -1937.101795094461,
        782.0527487285568
      ],
      "size": [
        291.400390625,
        226
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "ray_actors_init",
          "type": "RAY_ACTORS_INIT",
          "links": [
            1395
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayInitializer"
      },
      "widgets_values": [
        "local",
        "default",
        2,
        2,
        1,
        false,
        false,
        "TORCH"
      ]
    },
    {
      "id": 767,
      "type": "MarkdownNote",
      "pos": [
        -2341.129771089702,
        534.0621464515444
      ],
      "size": [
        365.2845153808594,
        860.39208984375
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Introduction",
      "properties": {},
      "widgets_values": [
        "## Raylight Overview\n\nAs the name implies, **Raylight** uses Ray workers, called *Actors*.  \nEach worker is its own Python process. While this allows splitting across multiple VRAMs,  \nit does increase overall RAM usage.  \n\nThat said, RAM is generally much cheaper than VRAM, so this trade-off is acceptable in most cases.  \n\n---\n\nMore info: [Raylight on GitHub](https://github.com/komikndr/raylight)\n\n\n## Supported Models\n\n| Model             | USP | FSDP |\n|-------------------|-----|------|\n| Wan2.1 1.3B T2V      | ✅  | ✅   |\n| Wan2.1 14B T2V       | ✅  | ✅   |\n| Wan2.1 14B I2V       | ✅  | ✅   |\n| Wan2.1 Vace             | ✅  | ❌   |\n| Wan2.2 5B TI2V       | ✅  | ✅   |\n| Wan2.2 14B I2V       | ✅  | ✅   |\n| Flux Dev          | ✅  | ✅   |\n| Flux Konteks      | ✅  | ✅   |\n| Flux ControlNet   | ❌  | ❌   |\n| Qwen Image        | ✅  | ✅   |\n| Hunyuan Video     | ❌  | ❓   |\n| Chroma             | ✅  | ✅  |\n| Chroma Radiance    | ✅  | ✅  |\n\n**Legend:**\n- ✅ = Supported\n- ❌ = Not currently supported\n- ❓ = Maybe work?\n\n**Notes:**\n- Non standard Wan variant (Phantom, S2V, etc...) is not tested\n\n## Scaled vs Non-Scaled Models\n\n| Model       | USP | FSDP |\n|-------------|-----|------|\n| Non-Scaled  | ✅  | ✅   |\n| Scaled      | ✅  | ⚠️ |\n\n**Notes:**\n- Scaled models use multiple dtypes inside their transformer blocks: typically **FP32** for scale, **FP16** for bias, and **FP8** for weights.\n- Only Ada Lovelace and newer GPUs support **FP8 scaled FSDP2**.\n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 770,
      "type": "Note",
      "pos": [
        -1948.4501343607608,
        365.8608450348316
      ],
      "size": [
        214.7521209716797,
        126.13883209228516
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Rule of thumb",
      "properties": {},
      "widgets_values": [
        "Just jack up more ulysses per number of GPUs, and set ring only 1.\n\nNo need FSDP if all of your model can be fitted into individual card. Especially image model who has low sequence length"
      ],
      "color": "#432",
      "bgcolor": "#653"
    }
  ],
  "links": [
    [
      1252,
      710,
      0,
      298,
      1,
      "VAE"
    ],
    [
      1341,
      298,
      0,
      740,
      0,
      "IMAGE"
    ],
    [
      1342,
      733,
      0,
      741,
      0,
      "CLIP"
    ],
    [
      1343,
      741,
      0,
      693,
      0,
      "CLIP"
    ],
    [
      1344,
      741,
      0,
      728,
      0,
      "CLIP"
    ],
    [
      1383,
      761,
      0,
      764,
      0,
      "RAY_ACTORS"
    ],
    [
      1384,
      761,
      0,
      765,
      0,
      "RAY_ACTORS"
    ],
    [
      1385,
      728,
      0,
      765,
      2,
      "CONDITIONING"
    ],
    [
      1386,
      693,
      0,
      765,
      1,
      "CONDITIONING"
    ],
    [
      1387,
      700,
      0,
      765,
      3,
      "SAMPLER"
    ],
    [
      1389,
      765,
      0,
      298,
      0,
      "LATENT"
    ],
    [
      1391,
      766,
      0,
      765,
      4,
      "SIGMAS"
    ],
    [
      1393,
      760,
      0,
      765,
      5,
      "LATENT"
    ],
    [
      1394,
      764,
      0,
      766,
      0,
      "RAY_ACTORS"
    ],
    [
      1395,
      773,
      0,
      761,
      0,
      "RAY_ACTORS_INIT"
    ]
  ],
  "groups": [
    {
      "id": 3,
      "title": "Sampler Settings",
      "bounding": [
        -1550,
        1060,
        674.7275151493147,
        550.7277373695194
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 4,
      "title": "Step 2: Image Size",
      "bounding": [
        -1956.9998888898974,
        1342.7955111518584,
        390,
        270
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 5,
      "title": "Step 1: Load models",
      "bounding": [
        -1953.4499828037392,
        509.8871458399756,
        385.3583661544865,
        820.6027670479225
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 6,
      "title": "Optional",
      "bounding": [
        -1547.8016222074946,
        509.7998444458565,
        472.40186664972225,
        538.800177776164
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 7,
      "title": "Step 3: Prompt",
      "bounding": [
        -1050,
        500,
        380,
        550
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.8642994331998064,
      "offset": [
        2734.8455313924846,
        -333.12932774998256
      ]
    },
    "frontendVersion": "1.28.7",
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true
  },
  "version": 0.4
}