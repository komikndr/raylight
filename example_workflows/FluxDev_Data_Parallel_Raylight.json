{
  "id": "74d472ce-c2b2-4c7b-aabc-51b7428dee99",
  "revision": 0,
  "last_node_id": 69,
  "last_link_id": 83,
  "nodes": [
    {
      "id": 33,
      "type": "CLIPTextEncode",
      "pos": [
        16.11848258972168,
        453.4114990234375
      ],
      "size": [
        422.8500061035156,
        164.30999755859375
      ],
      "flags": {
        "collapsed": false
      },
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 72
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            61
          ]
        }
      ],
      "title": "CLIP Text Encode (Negative Prompt)",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        ""
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 46,
      "type": "DualCLIPLoader",
      "pos": [
        -304.44873046875,
        368.29168701171875
      ],
      "size": [
        270,
        130
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            71,
            72
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "DualCLIPLoader"
      },
      "widgets_values": [
        "fluxte.safetensors",
        "clipl.safetensors",
        "flux",
        "default"
      ]
    },
    {
      "id": 49,
      "type": "MarkdownNote",
      "pos": [
        -691.6290283203125,
        -261.6722106933594
      ],
      "size": [
        363.9535217285156,
        819.131103515625
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Introduction",
      "properties": {},
      "widgets_values": [
        "## Raylight Overview\n\nAs the name implies, **Raylight** uses Ray workers, called *Actors*.  \nEach worker is its own Python process. While this allows splitting across multiple VRAMs,  \nit does increase overall RAM usage.  \n\nThat said, RAM is generally much cheaper than VRAM, so this trade-off is acceptable in most cases.  \n\n---\n\nMore info: [Raylight on GitHub](https://github.com/komikndr/raylight)\n\n\n## Supported Models\n\n| Model             | USP | FSDP |\n|-------------------|-----|------|\n| Wan2.1 1.3B T2V      | ✅  | ✅   |\n| Wan2.1 14B T2V       | ✅  | ✅   |\n| Wan2.1 14B I2V       | ✅  | ✅   |\n| Wan2.1 Vace             | ✅  | ❌   |\n| Wan2.2 5B TI2V       | ✅  | ✅   |\n| Wan2.2 14B I2V       | ✅  | ✅   |\n| Flux Dev          | ✅  | ✅   |\n| Flux Konteks      | ✅  | ✅   |\n| Flux ControlNet   | ❌  | ❌   |\n| Qwen Image        | ✅  | ✅   |\n| Hunyuan Video     | ❌  | ❓   |\n\n**Legend:**\n- ✅ = Supported\n- ❌ = Not currently supported\n- ❓ = Maybe work?\n\n**Notes:**\n- Non standard Wan variant (Phantom, S2V, etc...) is not tested\n\n## Scaled vs Non-Scaled Models\n\n| Model       | USP | FSDP |\n|-------------|-----|------|\n| Non-Scaled  | ✅  | ✅   |\n| Scaled      | ✅  | ⚠️ |\n\n**Notes:**\n- Scaled models use multiple dtypes inside their transformer blocks: typically **FP32** for scale, **FP16** for bias, and **FP8** for weights.\n- Only Ada Lovelace and newer GPUs support **FP8 scaled FSDP2**.\n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 27,
      "type": "EmptySD3LatentImage",
      "pos": [
        454.4710998535156,
        496.3222961425781
      ],
      "size": [
        315,
        106
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            81
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "EmptySD3LatentImage"
      },
      "widgets_values": [
        1024,
        1024,
        1
      ],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 39,
      "type": "easy cleanGpuUsed",
      "pos": [
        461.6951904296875,
        420.63916015625
      ],
      "size": [
        157.3892578125,
        26
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "anything",
          "type": "*",
          "link": 61
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "*",
          "links": [
            80
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "easy cleanGpuUsed"
      },
      "widgets_values": []
    },
    {
      "id": 40,
      "type": "easy cleanGpuUsed",
      "pos": [
        461.3198547363281,
        347.2921142578125
      ],
      "size": [
        157.3892578125,
        26
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "anything",
          "type": "*",
          "link": 62
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "*",
          "links": [
            79
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "easy cleanGpuUsed"
      },
      "widgets_values": []
    },
    {
      "id": 35,
      "type": "FluxGuidance",
      "pos": [
        460.78448486328125,
        237.94712829589844
      ],
      "size": [
        210,
        58
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 56
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            62
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "FluxGuidance"
      },
      "widgets_values": [
        3.5
      ]
    },
    {
      "id": 65,
      "type": "RayTorchCompileModel",
      "pos": [
        365.2783508300781,
        94.86715698242188
      ],
      "size": [
        270,
        58
      ],
      "flags": {},
      "order": 13,
      "mode": 4,
      "inputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "link": 76
        }
      ],
      "outputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "links": [
            78
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayTorchCompileModel"
      },
      "widgets_values": [
        "inductor"
      ]
    },
    {
      "id": 55,
      "type": "RayUNETLoader",
      "pos": [
        24.468101501464844,
        90.83113098144531
      ],
      "size": [
        270,
        102
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors_init",
          "type": "RAY_ACTORS_INIT",
          "link": 74
        },
        {
          "name": "lora",
          "shape": 7,
          "type": "RAY_LORA",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "links": [
            76
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayUNETLoader"
      },
      "widgets_values": [
        "flux_krea.safetensors",
        "default"
      ]
    },
    {
      "id": 6,
      "type": "CLIPTextEncode",
      "pos": [
        17.08505630493164,
        241.85986328125
      ],
      "size": [
        422.8500061035156,
        164.30999755859375
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 71
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            56
          ]
        }
      ],
      "title": "CLIP Text Encode (Positive Prompt)",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "A cat sleeping on a grass plain, while 2 graphic cards lay beside the cat"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 54,
      "type": "RayInitializer",
      "pos": [
        -311.276123046875,
        92.89726257324219
      ],
      "size": [
        291.400390625,
        226
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "ray_actors_init",
          "type": "RAY_ACTORS_INIT",
          "links": [
            74
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayInitializer"
      },
      "widgets_values": [
        "local",
        "default",
        2,
        0,
        0,
        true,
        false,
        "TORCH"
      ]
    },
    {
      "id": 48,
      "type": "VAELoader",
      "pos": [
        898.5384521484375,
        546.4091186523438
      ],
      "size": [
        270,
        58
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "links": [
            73
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAELoader"
      },
      "widgets_values": [
        "ae.safetensors"
      ]
    },
    {
      "id": 9,
      "type": "SaveImage",
      "pos": [
        1549.5865528957895,
        175.40502324380162
      ],
      "size": [
        392.3394775390625,
        441.7977600097656
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 9
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": [
        "ComfyUI"
      ]
    },
    {
      "id": 8,
      "type": "VAEDecode",
      "pos": [
        1693.8252356663224,
        -6.164495641534971
      ],
      "size": [
        210,
        46
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 82
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 73
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            9
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 66,
      "type": "DPKSamplerAdvanced",
      "pos": [
        1051.481963354695,
        19.487736394582704
      ],
      "size": [
        320.8921813964844,
        478
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "link": 78
        },
        {
          "name": "noise_list",
          "type": "NOISE",
          "link": 83
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 79
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 80
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 81
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "shape": 6,
          "type": "LATENT",
          "links": [
            82
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "DPKSamplerAdvanced"
      },
      "widgets_values": [
        "enable",
        0,
        "randomize",
        0,
        "randomize",
        0,
        "randomize",
        0
      ]
    },
    {
      "id": 50,
      "type": "Note",
      "pos": [
        -305.9508056640625,
        -82.63044738769531
      ],
      "size": [
        215.3394317626953,
        117.74829864501953
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Glosarry",
      "properties": {},
      "widgets_values": [
        "rank = id assigned to the GPU\nworld_size = number of GPUs\n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 67,
      "type": "DPNoiseList",
      "pos": [
        763.1563119688172,
        23.31595485635046
      ],
      "size": [
        270,
        418
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "NOISE",
          "shape": 6,
          "type": "NOISE",
          "links": [
            83
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "DPNoiseList"
      },
      "widgets_values": [
        0,
        "randomize",
        0,
        "randomize",
        0,
        "randomize",
        0,
        "randomize",
        0,
        "randomize",
        0,
        "randomize",
        0,
        "randomize",
        0,
        "randomize"
      ]
    },
    {
      "id": 69,
      "type": "MarkdownNote",
      "pos": [
        762.2323827078714,
        -215.70731313750073
      ],
      "size": [
        279.0017052757428,
        201.8240749260115
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Data Parallel",
      "properties": {},
      "widgets_values": [
        "This is to control how each worker got its noise\n- 0 -> GPU 0\n- 1 -> GPU 1\n- ...\n- 7 -> GPU 7\n\nWhy only 8? most of DGX Pods only contain upto 8 GPUs.\nIf you only want Distributed Worker \n\nwithout **FSDP** \n\njust use [ComfyUI-Distributed](https://github.com/robertvoy/ComfyUI-Distributed). This is just free byproduct of parallelism  \n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    }
  ],
  "links": [
    [
      9,
      8,
      0,
      9,
      0,
      "IMAGE"
    ],
    [
      56,
      6,
      0,
      35,
      0,
      "CONDITIONING"
    ],
    [
      61,
      33,
      0,
      39,
      0,
      "*"
    ],
    [
      62,
      35,
      0,
      40,
      0,
      "*"
    ],
    [
      71,
      46,
      0,
      6,
      0,
      "CLIP"
    ],
    [
      72,
      46,
      0,
      33,
      0,
      "CLIP"
    ],
    [
      73,
      48,
      0,
      8,
      1,
      "VAE"
    ],
    [
      74,
      54,
      0,
      55,
      0,
      "RAY_ACTORS_INIT"
    ],
    [
      76,
      55,
      0,
      65,
      0,
      "RAY_ACTORS"
    ],
    [
      78,
      65,
      0,
      66,
      0,
      "RAY_ACTORS"
    ],
    [
      79,
      40,
      0,
      66,
      2,
      "CONDITIONING"
    ],
    [
      80,
      39,
      0,
      66,
      3,
      "CONDITIONING"
    ],
    [
      81,
      27,
      0,
      66,
      4,
      "LATENT"
    ],
    [
      82,
      66,
      0,
      8,
      0,
      "LATENT"
    ],
    [
      83,
      67,
      0,
      66,
      1,
      "NOISE"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.9680000000000003,
      "offset": [
        168.51675604603113,
        321.2546242377113
      ]
    },
    "frontendVersion": "1.28.7"
  },
  "version": 0.4
}